{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"","title":"Home"},{"location":"Legal/","text":"Legal All product names, trademarks, registered trademarks, logos, and brands are property of their respective owners. All company, product, and service names used are for identification purposes only. Use of these names, trademarks, logos, and brands does not imply endorsement.","title":"Legal"},{"location":"Legal/#legal","text":"All product names, trademarks, registered trademarks, logos, and brands are property of their respective owners. All company, product, and service names used are for identification purposes only. Use of these names, trademarks, logos, and brands does not imply endorsement.","title":"Legal"},{"location":"License/","text":"License TODO Copyright \u00a9 2025 Natalie Moore Copyright \u00a9 2025 Ilya Smirnov Copyright \u00a9 2020 KFDtool, LLC","title":"License"},{"location":"License/#license","text":"TODO Copyright \u00a9 2025 Natalie Moore Copyright \u00a9 2025 Ilya Smirnov Copyright \u00a9 2020 KFDtool, LLC","title":"License"},{"location":"Development%20Docs/Cable%20Assembly/","text":"6 Pin Hirose Connector View: Female receptacle/jack viewed from mating face Male plug solder cups viewed from assembly face Pinout map / wire color map: 1 - RED (N/C) 2 - GRN (DATA) 3 - YEL (SENSE) 4 - BLK (GND) 5 - WHT (N/C) 6 - BLU (N/C) 6 Pin Male Plug Hirose P/N: HR10A-7P-6P(73) 6 Pin Female Jack Hirose P/N: HR10A-7J-6S(73) Cable Retention Crimp Tool Hirose P/N: HR10A-TC-02 5 Pin Amp Connector View: Female receptacle/jack viewed from mating face Male plug solder cups viewed from assembly face 5 Pin Male Plug (silver plated) Amp P/N: T3360001U 5 Pin Male Plug (gold plated) Amp P/N: T3360018U 8 Pin 8P8C Connector View: Male plug contacts from mating face Kenwood Portable Accessory Connector View: Female jack contacts from mating face (radio side) Motorola XTS4000 Accessory Connector View: Female jack contacts from mating face (radio side) 15 Pin DSUB Connector (2 row) View: Male plug solder cups viewed from assembly face Harris 9 Pin Portable Accessory Connector View: Female jack contacts from mating face (radio side) 3.5mm TRS Connector View: Male plug contacts Hirose RP13A-12PA-13SC View: Male plug contacts Hirose Jack to Motorola R2670 (KFDtool AC103A) 6 pin female jack Hirose to 5 pin male plug Amp Equivalent to Motorola TKN8210 cable Pinout: Amp Pin 1 - Hirose Pin 5 Amp Pin 2 - Hirose Pin 1 Amp Pin 3 - Hirose Pin 2 Amp Pin 4 - Hirose Pin 4 Amp Pin 5 - Hirose Pin 4 Hirose Jack to Kenwood KPG-115 Compatible (KFDtool AC104B) 6 pin female jack Hirose to 8 pin male plug 8P8C Equivalent to Kenwood KPG-115 cable Pinout: 8P8C Pin 1 - Hirose Pin 4 8P8C Pin 2 - Hirose Pin 2 8P8C Pin 5 - (Cathode) Schottky Diode (Anode) - Hirose Pin 2 8P8C Pin 6 - Hirose Pin 4 Hirose Jack to Kenwood KPG-93 Compatible (KFDtool AC106A) 6 pin female jack Hirose to male Kenwood portable accessory connector Equivalent to Kenwood KPG-93 cable Pinout: Accessory Pin 1 - Hirose Pin 4 Accessory Pin 8 - Hirose Pin 4 Accessory Pin 10 - Hirose Pin 4 Accessory Pin 12 - (Cathode) Schottky Diode (Anode) - Hirose Pin 2 Accessory Pin 13 - Hirose Pin 2 Hirose Jack to XTS4000 (KFDtool AC107A) 6 pin female jack Hirose to male Motorola XTS4000 accessory connector Equivalent to Motorola CKN6886/0182297T15 cable Pinout: Accessory Pin 1 - Hirose Pin 4 Accessory Pin 8 - Hirose Pin 4 Accessory Pin 9 - Hirose Pin 2 Accessory Pin 13 - Remove Hirose Jack to Aeroflex/IFR 2975 (KFDtool AC108A) 6 pin female jack Hirose to male 15 pin DSUB plug (2 row) Equivalent to Aeroflex/IFR cable 51190/6041-4201-200 Backshell must have a low profile due to faceplate protrusion Pinout: DB15 pin 5 - Hirose Pin 2 DB15 pin 7 - Hirose Pin 4 DB15 pin 8 - 2k Resistor - Hirose Pin 2 DB15 pin 13 - Hirose Pin 2 Hirose Jack to Harris Unity/XL (KFDtool AC109A) 6 pin female jack Hirose to male Harris 9 pin portable accessory connector Equivalent to Harris 12082-0400-A1 cable Pinout: Accessory Pin 3 - 20k Resistor - Hirose Pin 4 Accessory Pin 5 - Hirose Pin 4 Accessory Pin 6 - Hirose Pin 2 Accessory Pin 9 - Hirose Pin 4 Hirose Jack to 3.5mm Plug (KFDtool AC110A) 6 pin female jack Hirose to male 3.5mm TRS plug Pinout: TRS Tip - Hirose Pin 2 TRS Ring - Hirose Pin 3 TRS Sleeve - Hirose Pin 4 Hirose Jack to EF Johnson 5300ES (non-Lightning) 6 pin female jack Hirose to female 13-position Hirose RP13A-12PA-13SC Pinout: RP13A Pin 1 - Hirose Pin 2 RP13A Pin 3 - Hirose Pin 4 RP13A Pin 5 - Hirose Pin 4","title":"Cable Assembly"},{"location":"Development%20Docs/Cable%20Assembly/#6-pin-hirose-connector","text":"View: Female receptacle/jack viewed from mating face Male plug solder cups viewed from assembly face Pinout map / wire color map: 1 - RED (N/C) 2 - GRN (DATA) 3 - YEL (SENSE) 4 - BLK (GND) 5 - WHT (N/C) 6 - BLU (N/C) 6 Pin Male Plug Hirose P/N: HR10A-7P-6P(73) 6 Pin Female Jack Hirose P/N: HR10A-7J-6S(73) Cable Retention Crimp Tool Hirose P/N: HR10A-TC-02","title":"6 Pin Hirose Connector"},{"location":"Development%20Docs/Cable%20Assembly/#5-pin-amp-connector","text":"View: Female receptacle/jack viewed from mating face Male plug solder cups viewed from assembly face 5 Pin Male Plug (silver plated) Amp P/N: T3360001U 5 Pin Male Plug (gold plated) Amp P/N: T3360018U","title":"5 Pin Amp Connector"},{"location":"Development%20Docs/Cable%20Assembly/#8-pin-8p8c-connector","text":"View: Male plug contacts from mating face","title":"8 Pin 8P8C Connector"},{"location":"Development%20Docs/Cable%20Assembly/#kenwood-portable-accessory-connector","text":"View: Female jack contacts from mating face (radio side)","title":"Kenwood Portable Accessory Connector"},{"location":"Development%20Docs/Cable%20Assembly/#motorola-xts4000-accessory-connector","text":"View: Female jack contacts from mating face (radio side)","title":"Motorola XTS4000 Accessory Connector"},{"location":"Development%20Docs/Cable%20Assembly/#15-pin-dsub-connector-2-row","text":"View: Male plug solder cups viewed from assembly face","title":"15 Pin DSUB Connector (2 row)"},{"location":"Development%20Docs/Cable%20Assembly/#harris-9-pin-portable-accessory-connector","text":"View: Female jack contacts from mating face (radio side)","title":"Harris 9 Pin Portable Accessory Connector"},{"location":"Development%20Docs/Cable%20Assembly/#35mm-trs-connector","text":"View: Male plug contacts","title":"3.5mm TRS Connector"},{"location":"Development%20Docs/Cable%20Assembly/#hirose-rp13a-12pa-13sc","text":"View: Male plug contacts","title":"Hirose RP13A-12PA-13SC"},{"location":"Development%20Docs/Cable%20Assembly/#hirose-jack-to-motorola-r2670-kfdtool-ac103a","text":"6 pin female jack Hirose to 5 pin male plug Amp Equivalent to Motorola TKN8210 cable Pinout: Amp Pin 1 - Hirose Pin 5 Amp Pin 2 - Hirose Pin 1 Amp Pin 3 - Hirose Pin 2 Amp Pin 4 - Hirose Pin 4 Amp Pin 5 - Hirose Pin 4","title":"Hirose Jack to Motorola R2670 (KFDtool AC103A)"},{"location":"Development%20Docs/Cable%20Assembly/#hirose-jack-to-kenwood-kpg-115-compatible-kfdtool-ac104b","text":"6 pin female jack Hirose to 8 pin male plug 8P8C Equivalent to Kenwood KPG-115 cable Pinout: 8P8C Pin 1 - Hirose Pin 4 8P8C Pin 2 - Hirose Pin 2 8P8C Pin 5 - (Cathode) Schottky Diode (Anode) - Hirose Pin 2 8P8C Pin 6 - Hirose Pin 4","title":"Hirose Jack to Kenwood KPG-115 Compatible (KFDtool AC104B)"},{"location":"Development%20Docs/Cable%20Assembly/#hirose-jack-to-kenwood-kpg-93-compatible-kfdtool-ac106a","text":"6 pin female jack Hirose to male Kenwood portable accessory connector Equivalent to Kenwood KPG-93 cable Pinout: Accessory Pin 1 - Hirose Pin 4 Accessory Pin 8 - Hirose Pin 4 Accessory Pin 10 - Hirose Pin 4 Accessory Pin 12 - (Cathode) Schottky Diode (Anode) - Hirose Pin 2 Accessory Pin 13 - Hirose Pin 2","title":"Hirose Jack to Kenwood KPG-93 Compatible (KFDtool AC106A)"},{"location":"Development%20Docs/Cable%20Assembly/#hirose-jack-to-xts4000-kfdtool-ac107a","text":"6 pin female jack Hirose to male Motorola XTS4000 accessory connector Equivalent to Motorola CKN6886/0182297T15 cable Pinout: Accessory Pin 1 - Hirose Pin 4 Accessory Pin 8 - Hirose Pin 4 Accessory Pin 9 - Hirose Pin 2 Accessory Pin 13 - Remove","title":"Hirose Jack to XTS4000 (KFDtool AC107A)"},{"location":"Development%20Docs/Cable%20Assembly/#hirose-jack-to-aeroflexifr-2975-kfdtool-ac108a","text":"6 pin female jack Hirose to male 15 pin DSUB plug (2 row) Equivalent to Aeroflex/IFR cable 51190/6041-4201-200 Backshell must have a low profile due to faceplate protrusion Pinout: DB15 pin 5 - Hirose Pin 2 DB15 pin 7 - Hirose Pin 4 DB15 pin 8 - 2k Resistor - Hirose Pin 2 DB15 pin 13 - Hirose Pin 2","title":"Hirose Jack to Aeroflex/IFR 2975 (KFDtool AC108A)"},{"location":"Development%20Docs/Cable%20Assembly/#hirose-jack-to-harris-unityxl-kfdtool-ac109a","text":"6 pin female jack Hirose to male Harris 9 pin portable accessory connector Equivalent to Harris 12082-0400-A1 cable Pinout: Accessory Pin 3 - 20k Resistor - Hirose Pin 4 Accessory Pin 5 - Hirose Pin 4 Accessory Pin 6 - Hirose Pin 2 Accessory Pin 9 - Hirose Pin 4","title":"Hirose Jack to Harris Unity/XL (KFDtool AC109A)"},{"location":"Development%20Docs/Cable%20Assembly/#hirose-jack-to-35mm-plug-kfdtool-ac110a","text":"6 pin female jack Hirose to male 3.5mm TRS plug Pinout: TRS Tip - Hirose Pin 2 TRS Ring - Hirose Pin 3 TRS Sleeve - Hirose Pin 4","title":"Hirose Jack to 3.5mm Plug (KFDtool AC110A)"},{"location":"Development%20Docs/Cable%20Assembly/#hirose-jack-to-ef-johnson-5300es-non-lightning","text":"6 pin female jack Hirose to female 13-position Hirose RP13A-12PA-13SC Pinout: RP13A Pin 1 - Hirose Pin 2 RP13A Pin 3 - Hirose Pin 4 RP13A Pin 5 - Hirose Pin 4","title":"Hirose Jack to EF Johnson 5300ES (non-Lightning)"},{"location":"Development%20Docs/Environment/Firmware/","text":"Firmware Firmware environments differ based on the specified adapter. TI CCS The original KFDtool uses TI CCS 12. TODO Arduino Most adapters use Arduino-based firmware. TODO","title":"Firmware"},{"location":"Development%20Docs/Environment/Firmware/#firmware","text":"Firmware environments differ based on the specified adapter.","title":"Firmware"},{"location":"Development%20Docs/Environment/Firmware/#ti-ccs","text":"The original KFDtool uses TI CCS 12. TODO","title":"TI CCS"},{"location":"Development%20Docs/Environment/Firmware/#arduino","text":"Most adapters use Arduino-based firmware. TODO","title":"Arduino"},{"location":"Development%20Docs/Environment/Software/","text":"Software The KFDtool software is built using C# .NET Framework 4.8. A typical dev environment consists of Visual Studio with the Desktop App workload.","title":"Software"},{"location":"Development%20Docs/Environment/Software/#software","text":"The KFDtool software is built using C# .NET Framework 4.8. A typical dev environment consists of Visual Studio with the Desktop App workload.","title":"Software"},{"location":"User%20Docs/","text":"Keysmiths User Docs This section contains documentation for use of the Keysmiths application. Portions \u00a9 2020 Ellie Dugger under the MIT license","title":"Keysmiths User Docs"},{"location":"User%20Docs/#keysmiths-user-docs","text":"This section contains documentation for use of the Keysmiths application. Portions \u00a9 2020 Ellie Dugger under the MIT license","title":"Keysmiths User Docs"},{"location":"User%20Docs/Compatibility/","text":"Radio Compatibility Radios that have been specifically tested with KFD devices are listed below, along with any notes or firmware restrictions. If you have used KFDtool with a radio that is not listed, please get in touch so we can update this list! Product line Support status KFDtool software KFD firmware Radio firmware Notes Bendix King BK \u2754 Untested \u2014 \u2014 \u2014 Bendix King KNG \u2754 Untested \u2014 \u2014 \u2014 EF Johnson VP/VM 8000 \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any EF Johnson VP/VM x000 \u2754 Untested \u2014 \u2014 \u2014 EF Johnson VP/VM x00 \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 \u2265 8.28.5 EF Johnson 5100/ES \u2705 Tested \u2265 1.7.3 \u2265 1.7.3 \u2265 6.12.4 6 EF Johnson 5300/ES \u2754 Untested \u2014 \u2014 \u2014 Harris XL \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any Harris Unity (XG-100) \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any 1 Harris XG \u2754 Untested \u2014 \u2014 \u2014 4 Kenwood NX \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any 5 Kenwood TK \u2754 Untested \u2014 \u2014 \u2014 5 Motorola APX (TWI) \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any Motorola APX (DLI IP) \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 \u2265 R27.03 3 Motorola ASTRO 25 (MACE) \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any Motorola ASTRO 25 (UCM) \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any Motorola ASTRO \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 \u2265 R07.71.06, EMC R03.56 Thales Liberty \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any Tait TP/TM 9x00 series \u274c Not supported \u2014 \u2014 \u2014 XG-100M supports native TWI keyloading 2 only via CH100 \u21a9 XG-100M with CH721 supports TWI keyloading via Harris adapter cable 14002-0143-10 \u21a9 \"Freon\" (OMAP L-138) architecture only (APX 900, 6000 BN, 8000, 8500, NEXT, N-series, and BN mobiles) \u21a9 Harris XG radios require Harris adapter cable (portable: unknown part number; mobile: 14002-0143-10) \u21a9 Requires SCM hardware module \u21a9 \u21a9 Can use a modified Motorola XTS Hirose adapter (part number NTN8613C). See the Modifying an XTS Adapter page for more info \u21a9","title":"Compatibility"},{"location":"User%20Docs/Compatibility/#radio-compatibility","text":"Radios that have been specifically tested with KFD devices are listed below, along with any notes or firmware restrictions. If you have used KFDtool with a radio that is not listed, please get in touch so we can update this list! Product line Support status KFDtool software KFD firmware Radio firmware Notes Bendix King BK \u2754 Untested \u2014 \u2014 \u2014 Bendix King KNG \u2754 Untested \u2014 \u2014 \u2014 EF Johnson VP/VM 8000 \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any EF Johnson VP/VM x000 \u2754 Untested \u2014 \u2014 \u2014 EF Johnson VP/VM x00 \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 \u2265 8.28.5 EF Johnson 5100/ES \u2705 Tested \u2265 1.7.3 \u2265 1.7.3 \u2265 6.12.4 6 EF Johnson 5300/ES \u2754 Untested \u2014 \u2014 \u2014 Harris XL \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any Harris Unity (XG-100) \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any 1 Harris XG \u2754 Untested \u2014 \u2014 \u2014 4 Kenwood NX \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any 5 Kenwood TK \u2754 Untested \u2014 \u2014 \u2014 5 Motorola APX (TWI) \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any Motorola APX (DLI IP) \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 \u2265 R27.03 3 Motorola ASTRO 25 (MACE) \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any Motorola ASTRO 25 (UCM) \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any Motorola ASTRO \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 \u2265 R07.71.06, EMC R03.56 Thales Liberty \u2705 Tested \u2265 1.8.7 \u2265 1.8.7 Any Tait TP/TM 9x00 series \u274c Not supported \u2014 \u2014 \u2014 XG-100M supports native TWI keyloading 2 only via CH100 \u21a9 XG-100M with CH721 supports TWI keyloading via Harris adapter cable 14002-0143-10 \u21a9 \"Freon\" (OMAP L-138) architecture only (APX 900, 6000 BN, 8000, 8500, NEXT, N-series, and BN mobiles) \u21a9 Harris XG radios require Harris adapter cable (portable: unknown part number; mobile: 14002-0143-10) \u21a9 Requires SCM hardware module \u21a9 \u21a9 Can use a modified Motorola XTS Hirose adapter (part number NTN8613C). See the Modifying an XTS Adapter page for more info \u21a9","title":"Radio Compatibility"},{"location":"User%20Docs/Glossary/","text":"Glossary ADP - Advanced Digital Privacy AES - Advanced Encryption Standard CAPI - Cryptographic Application Programming Interface CBC - Cipher block chaining CKR - Common Key Reference DES - Data Encryption Standard DLI - Data Link Independent EKC - Encrypted Key Container IP - Internet Protocol IPv4 - Internet Protocol Version 4 IPv6 - Internet Protocol Version 6 IV - Initialization Vector KEK - Key Encryption Key KFD - Key Fill Device MR - Mobile Radio P25 - Project 25 PBKDF2 - Password-Based Key Derivation Function 2 PDF - Portable Document Format PPP - Point-to-Point Protocol RC4 - Rivest Cipher 4 RNDIS - Remote Network Driver Interface Specification SLN - Storage Location Number TEK - Traffic Encryption Key TWI - Three-Wire Interface UDP - User Datagram Protocol USB - Universal Serial Bus UTF-8 - 8-bit Unicode Transformation Format","title":"Glossary"},{"location":"User%20Docs/Glossary/#glossary","text":"ADP - Advanced Digital Privacy AES - Advanced Encryption Standard CAPI - Cryptographic Application Programming Interface CBC - Cipher block chaining CKR - Common Key Reference DES - Data Encryption Standard DLI - Data Link Independent EKC - Encrypted Key Container IP - Internet Protocol IPv4 - Internet Protocol Version 4 IPv6 - Internet Protocol Version 6 IV - Initialization Vector KEK - Key Encryption Key KFD - Key Fill Device MR - Mobile Radio P25 - Project 25 PBKDF2 - Password-Based Key Derivation Function 2 PDF - Portable Document Format PPP - Point-to-Point Protocol RC4 - Rivest Cipher 4 RNDIS - Remote Network Driver Interface Specification SLN - Storage Location Number TEK - Traffic Encryption Key TWI - Three-Wire Interface UDP - User Datagram Protocol USB - Universal Serial Bus UTF-8 - 8-bit Unicode Transformation Format","title":"Glossary"},{"location":"User%20Docs/Keyload%20Type/","text":"Keyload Types There are two supported protocols for keyloading - TWI and DLI. TWI TWI will fill keys via a physical serial link to the radio. This requires the use of an adapter (e.g. KFDtool, KFDShield, KFDmicro, etc.). A non-exhaustive list of compatible adapters can be found on the Adapters page. DLI DLI will fill keys via an IP link to the radio. The radio can be filled so long as it reachable by a route in the Windows routing table - for example, RNDIS over USB; PPP over serial; etc.","title":"Keyload Types"},{"location":"User%20Docs/Keyload%20Type/#keyload-types","text":"There are two supported protocols for keyloading - TWI and DLI.","title":"Keyload Types"},{"location":"User%20Docs/Keyload%20Type/#twi","text":"TWI will fill keys via a physical serial link to the radio. This requires the use of an adapter (e.g. KFDtool, KFDShield, KFDmicro, etc.). A non-exhaustive list of compatible adapters can be found on the Adapters page.","title":"TWI"},{"location":"User%20Docs/Keyload%20Type/#dli","text":"DLI will fill keys via an IP link to the radio. The radio can be filled so long as it reachable by a route in the Windows routing table - for example, RNDIS over USB; PPP over serial; etc.","title":"DLI"},{"location":"User%20Docs/P25%20MR/","text":"P25 MR P25 MR mode allows the adapter to emulate a target radio, in order to extract keys from an existing keyloader (e.g. Motorola KVL, Christie TKMD). To use the emulator functionality, first connect the target keyloader to your adapter using a suitable cable. The cable should be straight through, connecting the data and ground lines between keyloaders. Then, open the KFDtool software and select P25 MR -> Emulator. (IMAGE HERE) When ready, click Start. Use the target keyloader to fill a radio as normal. Logs should start to show on screen, and the key will be displayed, along with the SLN/CKR, KID, and AlgID. (IMAGE HERE)","title":"P25 MR"},{"location":"User%20Docs/P25%20MR/#p25-mr","text":"P25 MR mode allows the adapter to emulate a target radio, in order to extract keys from an existing keyloader (e.g. Motorola KVL, Christie TKMD). To use the emulator functionality, first connect the target keyloader to your adapter using a suitable cable. The cable should be straight through, connecting the data and ground lines between keyloaders. Then, open the KFDtool software and select P25 MR -> Emulator. (IMAGE HERE) When ready, click Start. Use the target keyloader to fill a radio as normal. Logs should start to show on screen, and the key will be displayed, along with the SLN/CKR, KID, and AlgID. (IMAGE HERE)","title":"P25 MR"},{"location":"User%20Docs/Security/","text":"Security Considerations This section is intended to be a non-exhaustive list of factors to consider when evaluating the security of a KFDtool system. P25 Keyloading Considerations Some radios store keys in software rather than hardware, making them potentially retrievable. What this means Some keys are stored in a hardware security module or HSM (e.g. UCM, MACE) which is very secure as barring an exploit for the specific chip being used, once written the keys are unable to be retrieved as plaintext from the HSM. Additionally, many HSMs have various methods of tamper detection to erase all keys if the unit is tampered with. This means that ideally, if an attacker had physical access to the radio, they would be unable to retrieve the key material from the radio. However, some radios store keys in software (e.g. software ADP, Motorola APX900 and Kenwood VP8000 software crypto), which has far fewer protections than a hardware security module. A skilled attacker, given enough time with a radio, could extract key material from a radio using software encryption. This is not to say that software encryption has no place; however it should be factored in when evaluating your individual threat model. Keys are forever. What this means It is not always possible to remotely erase a lost radio's keys for a multitude of reasons. Therefore, if a keyed radio is lost, any keys that were installed in it should be considered compromised. KFDtool-specific Considerations The KFDtool as a computer peripheral has several important considerations to keep in mind when secure keyloading is required. What this means Because the KFDtool keyloader is made up of a USB peripheral and software for use on a Windows PC, precautions have to be taken to preserve the integrity of the encryption keys due to the complex nature of the systems involved. The following points are only valid with unmodified software, firmware, and hardware. With physical access to the PC or adapter, the software, firmware, or hardware could be modified to covertly retain the plaintext keying material. What this means With physical access to the KFDtool adapter or computer running the KFDtool software, someone could modify them in a way to record or transmit the encryption keys without your knowledge. Therefore, you should physically secure the KFDtool adapter and the computer used for keyloading. Plaintext keying material is present in the PC's RAM, over the USB connection, in the adapter's RAM, and over the keyload connection. Therefore, you must trust the PC that the software is running on, or air gap it. What this means If the computer you use for keyloading is connected to a network, it is possible that the encryption keys could be accessed without your knowledge due to vulnerabilities in Windows or other software installed on your computer. Therefore, it is recommended that you use a computer that is not connected to any networks, and that you only install software and connect devices to it that you trust. It is possible that plaintext keying material in the PC's RAM is paged out to disk. It is also possible that Windows crash dumps may contain plaintext keying material. Therefore, it is recommended that the PC's hard drive is protected using full disk encryption such as BitLocker and powered off when unattended. What this means Windows is a complex operating system, and there are many ways for the encryption keys to end up on the hard drive without your knowledge. Therefore, encrypting the hard drive of the computer you use for keyloading is a good idea as it provides another layer of security against unauthorized users accessing the encryption keys without your knowledge. After the KFDtool adapter has been disconnected from the USB port, any residual plaintext keying material present in the microcontroller's RAM will be lost. What this means When unplugging the KFDtool adapter from the computer, any encryption keys are lost due to the memory type used. The KFDtool adapter by design does not store any encryption keys. When certain non-default logging is enabled, plaintext keying material is written out to the log file on disk. This logging should only be enabled when diagnostic information needs to be collected, and only used with dummy keying material. What this means There are options in the KFDtool software configuration files that can be set to write detailed information to the hard drive for use to diagnose issues. If you are directed to change these files to enable logging to diagnose an issue, understand that the keys you use may be included in these logs. Therefore, you should not use your production keys when collecting these logs.","title":"Security Considerations"},{"location":"User%20Docs/Security/#security-considerations","text":"This section is intended to be a non-exhaustive list of factors to consider when evaluating the security of a KFDtool system.","title":"Security Considerations"},{"location":"User%20Docs/Security/#p25-keyloading-considerations","text":"Some radios store keys in software rather than hardware, making them potentially retrievable. What this means Some keys are stored in a hardware security module or HSM (e.g. UCM, MACE) which is very secure as barring an exploit for the specific chip being used, once written the keys are unable to be retrieved as plaintext from the HSM. Additionally, many HSMs have various methods of tamper detection to erase all keys if the unit is tampered with. This means that ideally, if an attacker had physical access to the radio, they would be unable to retrieve the key material from the radio. However, some radios store keys in software (e.g. software ADP, Motorola APX900 and Kenwood VP8000 software crypto), which has far fewer protections than a hardware security module. A skilled attacker, given enough time with a radio, could extract key material from a radio using software encryption. This is not to say that software encryption has no place; however it should be factored in when evaluating your individual threat model. Keys are forever. What this means It is not always possible to remotely erase a lost radio's keys for a multitude of reasons. Therefore, if a keyed radio is lost, any keys that were installed in it should be considered compromised.","title":"P25 Keyloading Considerations"},{"location":"User%20Docs/Security/#kfdtool-specific-considerations","text":"The KFDtool as a computer peripheral has several important considerations to keep in mind when secure keyloading is required. What this means Because the KFDtool keyloader is made up of a USB peripheral and software for use on a Windows PC, precautions have to be taken to preserve the integrity of the encryption keys due to the complex nature of the systems involved. The following points are only valid with unmodified software, firmware, and hardware. With physical access to the PC or adapter, the software, firmware, or hardware could be modified to covertly retain the plaintext keying material. What this means With physical access to the KFDtool adapter or computer running the KFDtool software, someone could modify them in a way to record or transmit the encryption keys without your knowledge. Therefore, you should physically secure the KFDtool adapter and the computer used for keyloading. Plaintext keying material is present in the PC's RAM, over the USB connection, in the adapter's RAM, and over the keyload connection. Therefore, you must trust the PC that the software is running on, or air gap it. What this means If the computer you use for keyloading is connected to a network, it is possible that the encryption keys could be accessed without your knowledge due to vulnerabilities in Windows or other software installed on your computer. Therefore, it is recommended that you use a computer that is not connected to any networks, and that you only install software and connect devices to it that you trust. It is possible that plaintext keying material in the PC's RAM is paged out to disk. It is also possible that Windows crash dumps may contain plaintext keying material. Therefore, it is recommended that the PC's hard drive is protected using full disk encryption such as BitLocker and powered off when unattended. What this means Windows is a complex operating system, and there are many ways for the encryption keys to end up on the hard drive without your knowledge. Therefore, encrypting the hard drive of the computer you use for keyloading is a good idea as it provides another layer of security against unauthorized users accessing the encryption keys without your knowledge. After the KFDtool adapter has been disconnected from the USB port, any residual plaintext keying material present in the microcontroller's RAM will be lost. What this means When unplugging the KFDtool adapter from the computer, any encryption keys are lost due to the memory type used. The KFDtool adapter by design does not store any encryption keys. When certain non-default logging is enabled, plaintext keying material is written out to the log file on disk. This logging should only be enabled when diagnostic information needs to be collected, and only used with dummy keying material. What this means There are options in the KFDtool software configuration files that can be set to write detailed information to the hard drive for use to diagnose issues. If you are directed to change these files to enable logging to diagnose an issue, understand that the keys you use may be included in these logs. Therefore, you should not use your production keys when collecting these logs.","title":"KFDtool-specific Considerations"},{"location":"User%20Docs/XTS%20Adapter%20Mod/","text":"XTS Hirose adapter modification A Motorola NTN8613C Hirose adapter for XTS can be modified to be used on both Motorola and EF Johnson radios. However, there are some caveats: Audio accessories will continuously transmit when used with the adapter (OPT_SEL1 is pulled low by the audio accessory but OPT_SEL2 is tied low all the time) This may trigger the man down function as OPT_SEL2 is tied low all the time even when CTS is not pulled low (CTS low = keyload mode for Motorola, pulled low by KVL/KFDtool) For EFJ radios, you need to connect the adapter to the Hirose cable and the KVL/KFDtool first, then connect to the radio. If you connect the adapter to the radio first and then connect the Hirose cable it will not work. This is because multiple pins need to be asserted simultaneously for the EFJ radio to go into keyload mode. To complete the modification, use a soldering iron to bridge the two contacts shown in the image below:","title":"XTS Hirose adapter modification"},{"location":"User%20Docs/XTS%20Adapter%20Mod/#xts-hirose-adapter-modification","text":"A Motorola NTN8613C Hirose adapter for XTS can be modified to be used on both Motorola and EF Johnson radios. However, there are some caveats: Audio accessories will continuously transmit when used with the adapter (OPT_SEL1 is pulled low by the audio accessory but OPT_SEL2 is tied low all the time) This may trigger the man down function as OPT_SEL2 is tied low all the time even when CTS is not pulled low (CTS low = keyload mode for Motorola, pulled low by KVL/KFDtool) For EFJ radios, you need to connect the adapter to the Hirose cable and the KVL/KFDtool first, then connect to the radio. If you connect the adapter to the radio first and then connect the Hirose cable it will not work. This is because multiple pins need to be asserted simultaneously for the EFJ radio to go into keyload mode. To complete the modification, use a soldering iron to bridge the two contacts shown in the image below:","title":"XTS Hirose adapter modification"},{"location":"User%20Docs/Adapters/","text":"Adapters An adapter is necessary to fill a radio over TWI. A non-exhaustive list of known compatible adapters can be found below. KFDtool (original model) KVLMini (China clone) follows mostly the same information KFDShield KFDmicro KFDnano KFDpico","title":"Adapters"},{"location":"User%20Docs/Adapters/#adapters","text":"An adapter is necessary to fill a radio over TWI. A non-exhaustive list of known compatible adapters can be found below. KFDtool (original model) KVLMini (China clone) follows mostly the same information KFDShield KFDmicro KFDnano KFDpico","title":"Adapters"},{"location":"User%20Docs/Adapters/kfdmicro/","text":"KFDMicro The KFDMicro is a compact keyloader produced by W3AXL. Where to get it? KFDMicros can be purchased on store.w3axl.com","title":"KFDMicro"},{"location":"User%20Docs/Adapters/kfdmicro/#kfdmicro","text":"The KFDMicro is a compact keyloader produced by W3AXL.","title":"KFDMicro"},{"location":"User%20Docs/Adapters/kfdmicro/#where-to-get-it","text":"KFDMicros can be purchased on store.w3axl.com","title":"Where to get it?"},{"location":"User%20Docs/Adapters/kfdnano/","text":"KFDnano The KFDnano is a keyloader. Where to get it? The KFDnano is no longer actively produced.","title":"KFDnano"},{"location":"User%20Docs/Adapters/kfdnano/#kfdnano","text":"The KFDnano is a keyloader.","title":"KFDnano"},{"location":"User%20Docs/Adapters/kfdnano/#where-to-get-it","text":"The KFDnano is no longer actively produced.","title":"Where to get it?"},{"location":"User%20Docs/Adapters/kfdpico/","text":"KFDpico The KFDpico is an extremely small keyloader. Where to get it?","title":"KFDpico"},{"location":"User%20Docs/Adapters/kfdpico/#kfdpico","text":"The KFDpico is an extremely small keyloader.","title":"KFDpico"},{"location":"User%20Docs/Adapters/kfdpico/#where-to-get-it","text":"","title":"Where to get it?"},{"location":"User%20Docs/Adapters/kfdshield/","text":"KFDShield The KFDShield is a development add-on for an Arduino microcontroller. It was originally developed for the Arduino Uno R3 and later the Arduino Mega 2560. Where to get it? The KFDShield is no longer being actively manufactured.","title":"KFDShield"},{"location":"User%20Docs/Adapters/kfdshield/#kfdshield","text":"The KFDShield is a development add-on for an Arduino microcontroller. It was originally developed for the Arduino Uno R3 and later the Arduino Mega 2560.","title":"KFDShield"},{"location":"User%20Docs/Adapters/kfdshield/#where-to-get-it","text":"The KFDShield is no longer being actively manufactured.","title":"Where to get it?"},{"location":"User%20Docs/Adapters/kfdtool/","text":"KFDtool The KFDtool is the original keyloader project the rest are based off. Where to get it? They have been unavailable since 2020 due to chip shortages, but another production run is planned in the future. The official store is kfdtool.com/store .","title":"KFDtool"},{"location":"User%20Docs/Adapters/kfdtool/#kfdtool","text":"The KFDtool is the original keyloader project the rest are based off.","title":"KFDtool"},{"location":"User%20Docs/Adapters/kfdtool/#where-to-get-it","text":"They have been unavailable since 2020 due to chip shortages, but another production run is planned in the future. The official store is kfdtool.com/store .","title":"Where to get it?"},{"location":"User%20Docs/Container/","text":"Container Key containers can be used to house multiple keys in an easily transportable format. Individual keys and groups of keys to be stored and used in other features of the software. The container can be saved on disk and opened on the same or another machine. Security When saved to disk, the container is encrypted with the AES-256 symmetric encryption algorithm using the CBC mode of operation. The 256 bit AES key is derived from the user entered password by the PBKDF2 key derivation algorithm using the SHA-512 hash algorithm, with 100,000 iterations, and using a 256 bit random salt value generated by the Windows CAPI. The password derived AES key is set on creation of the container and changed on the user initiated password change operation. A new AES IV is generated on each save of the container, generated by the Windows CAPI. The password length does not have an arbitrary upper limit, and can contain any characters representable in UTF-8. The lower limit of the password length is 1 character, but a message is displayed when setting the password to a value that is under 16 characters, encouraging the user to select a stronger password \u2013 however this is only a suggestion.","title":"Container"},{"location":"User%20Docs/Container/#container","text":"Key containers can be used to house multiple keys in an easily transportable format. Individual keys and groups of keys to be stored and used in other features of the software. The container can be saved on disk and opened on the same or another machine.","title":"Container"},{"location":"User%20Docs/Container/#security","text":"When saved to disk, the container is encrypted with the AES-256 symmetric encryption algorithm using the CBC mode of operation. The 256 bit AES key is derived from the user entered password by the PBKDF2 key derivation algorithm using the SHA-512 hash algorithm, with 100,000 iterations, and using a 256 bit random salt value generated by the Windows CAPI. The password derived AES key is set on creation of the container and changed on the user initiated password change operation. A new AES IV is generated on each save of the container, generated by the Windows CAPI. The password length does not have an arbitrary upper limit, and can contain any characters representable in UTF-8. The lower limit of the password length is 1 character, but a message is displayed when setting the password to a value that is under 16 characters, encouraging the user to select a stronger password \u2013 however this is only a suggestion.","title":"Security"},{"location":"User%20Docs/Export/DKF%20Export/","text":"DKF Export An option is provided to export the key container to a DKF file utilized by Harris KeyLoader. TODO","title":"DKF Export"},{"location":"User%20Docs/Export/DKF%20Export/#dkf-export","text":"An option is provided to export the key container to a DKF file utilized by Harris KeyLoader. TODO","title":"DKF Export"},{"location":"User%20Docs/Export/Elite%20Export/","text":"Elite Export An option is provided to export a key or keys into a format used by the Motorola MCC Elite series of dispatch consoles. Requirements 7-Zip is required to be installed before a key export can be made. TODO","title":"Elite Export"},{"location":"User%20Docs/Export/Elite%20Export/#elite-export","text":"An option is provided to export a key or keys into a format used by the Motorola MCC Elite series of dispatch consoles.","title":"Elite Export"},{"location":"User%20Docs/Export/Elite%20Export/#requirements","text":"7-Zip is required to be installed before a key export can be made. TODO","title":"Requirements"}]}